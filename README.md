# Travel Planner App 設計提案

這是一款可輸入「旅遊地點 + 時間」後，自動產生最佳路線的智慧旅遊 App。

## 1) 產品目標

使用者只要輸入：
- 出發地 / 目的地
- 旅遊日期與可用時段
- 預算偏好（省錢 / 省時 / 平衡）

App 會自動整合：
- **最佳路線規劃**（依時間、交通、景點營業時間）
- **多交通工具選項**（步行、捷運、公車、火車、叫車、租車）
- **交通與門票花費估算**
- **當地即時/預測天氣**（溫度、降雨、體感、警示）

## 2) 核心功能（MVP）

1. **行程輸入精靈**
   - 輸入城市、日期、每日可用時間、旅伴類型（親子/長輩/背包客）。
2. **自動行程規劃**
   - 產生 Day 1~N 行程，含建議停留時間、移動時間、備案。
3. **交通比較卡片**
   - 各交通方式列出：時間、費用、轉乘次數、步行距離、舒適度。
4. **費用總覽**
   - 交通、住宿、門票、餐飲預估 + 總預算落差。
5. **天氣整合**
   - 顯示各時段天氣，若降雨機率高則自動改成室內景點或調整順序。
6. **一鍵重新規劃**
   - 可設定「更省錢」「少走路」「避開雨天」快速重排。

## 3) 推薦技術架構

- Frontend: Flutter（iOS/Android 同一套程式碼）
- Backend API: FastAPI / Node.js（TypeScript）
- 資料庫: PostgreSQL + PostGIS（地理查詢）
- 快取: Redis（路線與天氣快取）
- 排程器: Celery / BullMQ（背景更新天氣與票價）
- 地圖與路線服務: Google Maps Platform / Mapbox / OpenTripPlanner
- 天氣服務: OpenWeather / WeatherAPI / 氣象局資料

## 4) 智慧排程邏輯（重點）

路線優化可用加權評分：

`Score = a*總移動時間 + b*總費用 + c*步行負擔 + d*天氣風險 + e*轉乘成本`

- 依使用者偏好動態調整權重 a~e。
- 套用限制條件：
  - 景點營業時間
  - 最晚返回時間
  - 每日最大移動距離
  - 天氣限制（暴雨時避開戶外）

可先採用「啟發式 + 局部最佳化」：
1. 先以距離/開放時間做初排。
2. 用 2-opt/交換法改善順序。
3. 針對天氣與交通中斷做動態重排。

## 5) 主要使用流程（User Journey）

1. 建立旅程（地點、日期、偏好）
2. 系統抓取景點、交通、天氣、成本資料
3. 產生最佳化行程
4. 使用者可微調（加/刪景點）
5. 行程出發當天提供即時提醒（天氣、延誤、替代路線）

## 6) 未來可擴充

- AI 聊天規劃師（像導遊，支援自然語言需求）
- 多人協作投票（朋友共同決定行程）
- 離線地圖與行程
- 即時票價與擁擠度預測
- 自動產生旅遊保險/簽證提醒

---

更完整的系統與 API 設計請見 `docs/system-design.md`。
